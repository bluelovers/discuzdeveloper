<!--{template common/header}-->

<script type="text/javascript" src="{$_G[setting][jspath]}register.js?{VERHASH}"></script>

<div id="ct" class="wp cl">
	<div class="nfl" id="main_regsucceed" style="display: none">
		<div class="f_c altw">
			<div class="alert_right">
				<p id="succeedmessage"></p>
				<p id="succeedlocation" class="alert_btnleft"></p>
				<p class="alert_btnleft"><a id="succeedmessage_href">{lang message_forward}</a></p>
			</div>
		</div>
	</div>
	<div class="mn">

<div class="bm" id="main_regmessage">

	<div class="bm_h bbs" id="main_hnav">
		<span class="y">
			<!--{hook/register_side_top}-->
			<!--{if $_G[gp_action] == 'activation'}-->
				{lang login_inactive}
			<!--{else}-->
				<a href="member.php?mod=logging&action=login&referer={echo rawurlencode($dreferer)}" onclick="showWindow('login', this.href);return false;" class="xi2">{lang login_now}</a>
			<!--{/if}-->
		</span>
		<h3 id="layer_reginfo_t" class="xs2">
			<!--{if $_G[gp_action] != 'activation'}-->$_G['setting']['reglinkname']<!--{else}-->{lang index_activation}<!--{/if}-->
		</h3>
	</div>

	<p id="returnmessage4"></p>

	<!--BBRULE Start-->
	<div id="layer_bbrule" class="bm_c"{if !($bbrules && $bbrulesforce)} style="display: none"{/if}>
		<h3 class="mtw hm xs2">$_G['setting']['bbname'] {lang rulemessage}</h3>
		<div class="rfm bw0 xs2">$bbrulestxt</div>
		<p class="fsb pns cl hm">
			<button class="pn pnc" onclick="$('agreebbrule').checked = true;display('layer_reg');display('layer_reginfo_b');display('layer_bbrule');{if $_G['setting']['sitemessage'][register] && ($bbrules && $bbrulesforce)}showRegprompt();{/if}"><span>{lang agree}</span></button>
			<button class="pn" onclick="location.href='$dreferer'"><span>{lang disagree}</span></button>
		</p>
	</div>
	<!--BBRULE End-->


	<form method="post" autocomplete="off" name="register" id="registerform" enctype="multipart/form-data" onsubmit="checksubmit();return false;" action="member.php?mod=$regname">
		<div id="layer_reg" class="bm_c"{if $bbrules && $bbrulesforce} style="display: none"{/if}>
			<input type="hidden" name="regsubmit" value="yes" />
			<input type="hidden" name="formhash" value="{FORMHASH}" />
			<input type="hidden" name="referer" value="$dreferer" />
			<input type="hidden" name="activationauth" value="{if $_G[gp_action] == 'activation'}$activationauth{/if}" />
			<div class="mtw">
				<div id="reginfo_a">
					<!--{hook/register_top}-->

					<!--{if $_G[gp_action] != 'activation'}-->

						<!--{if $invite}-->
							<!--{if $invite['uid']}-->
							<div class="rfm">
								<table>
									<tr>
										<th>{lang register_from}:</th>
										<td><a href="home.php?mod=space&uid=$invite[uid]" target="_blank">$invite[username]</a></td>
									</tr>
								</table>
							</div>
							<!--{else}-->
							<div class="rfm">
								<table>
									<tr>
										<th><label for="invitecode">{lang invite_code}:</label></th>
										<td>$_G[gp_invitecode]<input type="hidden" id="invitecode" name="invitecode" value="$_G[gp_invitecode]" /></td>
									</tr>
								</table>
							</div>
							<!--{/if}-->
						<!--{/if}-->

						<!--{if empty($invite) && $_G['setting']['regstatus'] == 2 && !$invitestatus}-->
						<div class="rfm">
							<table>
								<tr>
									<th><span class="rq">*</span><label for="invitecode">{lang invite_code}:</label></th>
									<td><input type="text" id="invitecode" name="invitecode" autocomplete="off" size="25" onblur="checkinvite()" tabindex="1" class="px" required /><!--{if $_G['setting']['inviteconfig']['buyinvitecode'] && $_G['setting']['inviteconfig']['invitecodeprice'] && ($_G[setting][ec_tenpay_bargainor] || $_G[setting][ec_tenpay_opentrans_chnid] || $_G[setting][ec_account])}--><p><a href="misc.php?mod=buyinvitecode" target="_blank" class="xi2">{lang register_buyinvitecode}</a></p><!--{/if}--></td>
									<td class="tipcol"><i id="tip_invitecode" class="p_tip"><!--{if $_G['setting']['inviteconfig']['invitecodeprompt']}-->$_G['setting'][inviteconfig][invitecodeprompt]<!--{/if}--></i><kbd id="chk_invitecode" class="p_chk"></kbd></td>
								</tr>
							</table>
						</div>
						<!--{/if}-->

						<div class="rfm">
							<table>
								<tr>
									<th><span class="rq">*</span><label for="regusername">{lang username}:</label></th>
									<td><input type="text" id="regusername" name="{$_G['setting']['reginput']['username']}" class="px" tabindex="1" autocomplete="off" size="25" maxlength="15" required onblur="checkusername()" /></td>
									<td class="tipcol"><i id="tip_regusername" class="p_tip">{lang register_username_tips}</i><kbd id="chk_regusername" class="p_chk"></kbd></td>
								</tr>
							</table>
						</div>

						<div id="main_password">
							<div class="rfm">
								<table>
									<tr>
										<th><span class="rq">*</span><label for="regpassword">{lang password}:</label></th>
										<td><input type="password" name="{$_G['setting']['reginput']['password']}" size="25" id="regpassword" tabindex="1" class="px" required onblur="checkpassword()" /></td>
										<td class="tipcol"><i id="tip_regpassword" class="p_tip">{lang register_password_tips}</i><kbd id="chk_regpassword" class="p_chk"></kbd></td>
									</tr>
								</table>
							</div>

							<div class="rfm">
								<table>
									<tr>
										<th><span class="rq">*</span><label for="regpassword2">{lang password_confirm}:</label></th>
										<td><input type="password" name="{$_G['setting']['reginput']['password2']}" size="25" id="regpassword2" tabindex="1" value="" class="px" required onblur="checkpassword()" /></td>
										<td class="tipcol"><i id="tip_regpassword2" class="p_tip">{lang register_repassword_tips}</i><kbd id="chk_regpassword2" class="p_chk"></kbd></td>
									</tr>
								</table>
							</div>
						</div>

						<div class="rfm">
							<table>
								<tr>
									<th><span class="rq">*</span><label for="email">{lang email}:</label></th>
									<td><input type="text" name="{$_G['setting']['reginput']['email']}" onclick="emailMenu(event)" onkeyup="emailMenu(event)" onkeydown="emailMenuOp(4, event)"  onblur="emailMenuOp(3)" autocomplete="off" size="25" id="email" tabindex="1" class="px" required /><br /><em id="emailmore">&nbsp;</em></td>
									<td class="tipcol"><i id="tip_email" class="p_tip">{lang register_email_tips}</i><kbd id="chk_email" class="p_chk"></kbd></td>
								</tr>
							</table>
						</div>
					<!--{/if}-->

					<!--{if $_G[gp_action] == 'activation'}-->
					<div id="activation_user" class="rfm">
						<table>
							<tr>
								<th>{lang username}:</th>
								<td><strong>$username</strong></td>
							</tr>
						</table>
					</div>
					<!--{/if}-->

					<!--{if $_G['setting']['regverify'] == 2}-->
					<div class="rfm">
						<table>
							<tr>
								<th><span class="rq">*</span><label for="regmessage">{lang register_message}:</label></th>
								<td><input id="regmessage" name="regmessage" class="px" autocomplete="off" size="25" tabindex="1" required /></td>
								<td class="tipcol"><i id="tip_regmessage" class="p_tip">{lang register_message1}</i></td>
							</tr>
						</table>
					</div>
					<!--{/if}-->

					<!--{if empty($invite) && $_G['setting']['regstatus'] == 3}-->
					<div class="rfm">
						<table>
							<tr>
								<th><label for="invitecode">{lang invite_code}:</label></th>
								<td><input type="text" name="invitecode" autocomplete="off" size="25" id="invitecode"{if $_G['setting']['regstatus'] == 2} onblur="checkinvite()"{/if} tabindex="1" class="px" /></td>
							</tr>
						</table>
					</div>
					<!--{/if}-->

					<!--{loop $_G['cache']['fields_register'] $field}-->
						<!--{if $htmls[$field['fieldid']]}-->
						<div class="rfm">
							<table>
								<tr>
									<th><!--{if $field['required']}--><span class="rq">*</span><!--{/if}--><label for="$field['fieldid']">$field[title]:</label></th>
									<td>$htmls[$field['fieldid']]</td>
									<td class="tipcol"><i id="tip_$field['fieldid']" class="p_tip"><!--{if $field['description']}--><!--{echo htmlspecialchars($field[description])}--><!--{/if}--></i><kbd id="chk_$field['fieldid']" class="p_chk"></kbd></td>
								</tr>
							</table>
						</div>
						<!--{/if}-->
					<!--{/loop}-->

					<!--{hook/register_input}-->

					<!--{if $secqaacheck || $seccodecheck}-->
						<!--{block sectpl}--><div class="rfm"><table><tr><th><span class="rq">*</span><sec>: </th><td><sec><br /><sec></td></tr></table></div><!--{/block}-->
						<!--{subtemplate common/seccheck}-->
					<!--{/if}-->

				</div>

			</div>

		</div>

		<div id="layer_reginfo_b" class="rfm mbw bw0"{if $bbrules && $bbrulesforce} style="display: none"{/if}>
			<table width="100%">
				<tr>
					<th>&nbsp;</th>
					<td>
						<span id="reginfo_a_btn">
							<!--{if $_G[gp_action] != 'activation'}--><em>&nbsp;</em><!--{/if}-->
								<button class="pn pnc" id="registerformsubmit" type="submit" name="regsubmit" value="true" tabindex="1"><span><!--{if $_G[gp_action] == 'activation'}-->{lang activation}<!--{else}-->{lang submit}<!--{/if}--></span></button>
							<!--{if $bbrules}-->
								<input type="checkbox" class="pc" name="agreebbrule" value="$bbrulehash" id="agreebbrule" checked="checked" /> <label for="agreebbrule">{lang agree}<a href="javascript:;" onclick="display('layer_reg');display('layer_reginfo_b');display('layer_bbrule');">{lang rulemessage}</a></label>
							<!--{/if}-->
						</span>
					</td>
					<td><!--{if $_G['setting']['sitemessage'][register]}--><a href="javascript:;" id="custominfo_register" class="y"><img src="{IMGDIR}/info_small.gif" alt="{lang faq}" /></a><!--{/if}--></td>
				</tr>
			</table>
		</div>
	</form>
	<!--{hook/register_bottom}-->
</div>
<div id="layer_regmessage"class="f_c blr nfl" style="display: none">
	<div class="c"><div class="alert_right">
		<div id="messageleft1"></div>
		<p class="alert_btnleft" id="messageright1"></p>
	</div>
</div>

<script type="text/javascript">
addFormEvent('registerform');

<!--{if $_G[gp_action] != 'activation' && !($bbrules && $bbrulesforce) }-->
	<!--{if empty($invite) && $_G['setting']['regstatus'] == 2}-->
		$('invitecode').focus();
	<!--{else}-->
		$('regusername').focus();
	<!--{/if}-->
<!--{/if}-->

<!--{if $_G['setting']['sitemessage'][register]}-->
	function showRegprompt() {
		showPrompt('custominfo_register', 'mouseover', '<!--{echo trim($_G['setting']['sitemessage'][register][array_rand($_G['setting']['sitemessage'][register])])}-->', $_G['setting']['sitemessage'][time]);
	}
	<!--{if !($bbrules && $bbrulesforce)}-->
		showRegprompt();
	<!--{/if}-->
<!--{/if}-->
</script>

	</div></div>
</div>

<!--{eval updatesession();}-->
<!--{template common/footer}-->